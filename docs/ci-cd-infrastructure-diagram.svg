<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1600 1680" font-family="Arial, sans-serif">
  <defs>
    <linearGradient id="triggerGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4A90E2;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#357ABD;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="workflowGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#7B68EE;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#5B4DB8;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="jobGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#50C878;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#3A9B5E;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="stepGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#FFB84D;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E69A3D;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="hookGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#FF6B6B;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E55555;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#666"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="1600" height="1680" fill="#F5F7FA"/>
  
  <!-- Title -->
  <text x="800" y="40" font-size="32" font-weight="bold" text-anchor="middle" fill="#2C3E50">
    Automaspec CI/CD Infrastructure Diagram
  </text>
  
  <!-- Git Hooks Section -->
  <rect x="50" y="80" width="1500" height="280" rx="10" fill="white" stroke="#E0E0E0" stroke-width="2" filter="url(#shadow)"/>
  <text x="800" y="110" font-size="20" font-weight="bold" text-anchor="middle" fill="#2C3E50">Git Hooks (Lefthook)</text>
  
  <!-- Pre-commit Hooks -->
  <rect x="100" y="140" width="450" height="200" rx="8" fill="url(#hookGrad)" opacity="0.9"/>
  <text x="325" y="165" font-size="16" font-weight="bold" text-anchor="middle" fill="white">Pre-commit Hooks</text>
  <text x="325" y="190" font-size="12" text-anchor="middle" fill="white">Trigger: *.ts, *.tsx, *.mts</text>
  
  <rect x="120" y="210" width="130" height="50" rx="5" fill="white" opacity="0.9"/>
  <text x="185" y="230" font-size="11" text-anchor="middle" fill="#333">DB Check</text>
  <text x="185" y="245" font-size="9" text-anchor="middle" fill="#666">pnpm dbc</text>
  
  <rect x="270" y="210" width="130" height="50" rx="5" fill="white" opacity="0.9"/>
  <text x="335" y="230" font-size="11" text-anchor="middle" fill="#333">Format</text>
  <text x="335" y="245" font-size="9" text-anchor="middle" fill="#666">pnpm format</text>
  
  <rect x="420" y="210" width="110" height="50" rx="5" fill="white" opacity="0.9"/>
  <text x="475" y="230" font-size="11" text-anchor="middle" fill="#333">Lint</text>
  <text x="475" y="245" font-size="9" text-anchor="middle" fill="#666">pnpm lint</text>
  
  <!-- Pre-push Hooks -->
  <rect x="600" y="140" width="450" height="200" rx="8" fill="url(#hookGrad)" opacity="0.9"/>
  <text x="825" y="165" font-size="16" font-weight="bold" text-anchor="middle" fill="white">Pre-push Hooks (Parallel)</text>
  <text x="825" y="190" font-size="12" text-anchor="middle" fill="white">Trigger: *.ts, *.tsx, *.mts</text>
  
  <rect x="620" y="210" width="200" height="50" rx="5" fill="white" opacity="0.9"/>
  <text x="720" y="230" font-size="11" text-anchor="middle" fill="#333">Type Check</text>
  <text x="720" y="245" font-size="9" text-anchor="middle" fill="#666">pnpm typecheck</text>
  
  <rect x="840" y="210" width="190" height="50" rx="5" fill="white" opacity="0.9"/>
  <text x="935" y="230" font-size="11" text-anchor="middle" fill="#333">Tests</text>
  <text x="935" y="245" font-size="9" text-anchor="middle" fill="#666">pnpm test run</text>
  
  <!-- Arrow from hooks to workflows -->
  <path d="M 800 380 L 800 420" stroke="#666" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- Triggers Section -->
  <rect x="50" y="420" width="1500" height="180" rx="10" fill="white" stroke="#E0E0E0" stroke-width="2" filter="url(#shadow)"/>
  <text x="800" y="450" font-size="20" font-weight="bold" text-anchor="middle" fill="#2C3E50">Workflow Triggers</text>
  
  <rect x="150" y="470" width="300" height="100" rx="8" fill="url(#triggerGrad)" opacity="0.9"/>
  <text x="300" y="500" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Push Events</text>
  <text x="300" y="525" font-size="11" text-anchor="middle" fill="white">main, master, dev</text>
  <text x="300" y="545" font-size="10" text-anchor="middle" fill="white">Triggers: CI/CD, Test Sync</text>
  
  <rect x="500" y="470" width="300" height="100" rx="8" fill="url(#triggerGrad)" opacity="0.9"/>
  <text x="650" y="500" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Pull Request</text>
  <text x="650" y="525" font-size="11" text-anchor="middle" fill="white">Target: main, master, dev</text>
  <text x="650" y="545" font-size="10" text-anchor="middle" fill="white">Triggers: CI/CD, Test Sync</text>
  
  <rect x="850" y="470" width="300" height="100" rx="8" fill="url(#triggerGrad)" opacity="0.9"/>
  <text x="1000" y="500" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Manual Dispatch</text>
  <text x="1000" y="525" font-size="11" text-anchor="middle" fill="white">Workflow Dispatch</text>
  <text x="1000" y="545" font-size="10" text-anchor="middle" fill="white">Test Sync workflow</text>
  
  <!-- Arrow from triggers to workflows -->
  <path d="M 800 600 L 800 640" stroke="#666" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- Workflow 1: CI/CD Pipeline -->
  <rect x="50" y="640" width="1500" height="440" rx="10" fill="white" stroke="#E0E0E0" stroke-width="2" filter="url(#shadow)"/>
  <rect x="70" y="660" width="1460" height="40" rx="5" fill="url(#workflowGrad)" opacity="0.9"/>
  <text x="800" y="685" font-size="18" font-weight="bold" text-anchor="middle" fill="white">Workflow 1: CI/CD Pipeline (ci-cd.yml)</text>
  
  <!-- Quality Checks Job -->
  <rect x="100" y="720" width="700" height="320" rx="8" fill="url(#jobGrad)" opacity="0.9"/>
  <text x="450" y="750" font-size="16" font-weight="bold" text-anchor="middle" fill="white">Job: Quality Checks</text>
  <text x="450" y="770" font-size="12" text-anchor="middle" fill="white">Runner: ubuntu-latest</text>
  
  <rect x="130" y="790" width="640" height="30" rx="5" fill="white" opacity="0.9"/>
  <text x="450" y="810" font-size="11" text-anchor="middle" fill="#333">1. Setup environment (pnpm, Node.js 22)</text>
  
  <rect x="130" y="830" width="640" height="30" rx="5" fill="white" opacity="0.9"/>
  <text x="450" y="850" font-size="11" text-anchor="middle" fill="#333">2. Install dependencies</text>
  
  <rect x="130" y="870" width="640" height="30" rx="5" fill="white" opacity="0.9"/>
  <text x="450" y="890" font-size="11" text-anchor="middle" fill="#333">3. Code quality checks (format, lint, db-check)</text>
  
  <rect x="130" y="910" width="640" height="30" rx="5" fill="white" opacity="0.9"/>
  <text x="450" y="930" font-size="11" text-anchor="middle" fill="#333">4. Type checking & tests</text>
  
  <rect x="130" y="950" width="640" height="70" rx="5" fill="#FFE5E5" opacity="0.8"/>
  <text x="450" y="975" font-size="11" font-weight="bold" text-anchor="middle" fill="#C00">Required for deployment</text>
  <text x="450" y="995" font-size="10" text-anchor="middle" fill="#666">All checks must pass</text>
  
  <!-- Deploy Preview Job -->
  <rect x="850" y="720" width="300" height="180" rx="8" fill="url(#jobGrad)" opacity="0.9"/>
  <text x="1000" y="750" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Deploy Preview</text>
  <text x="1000" y="770" font-size="11" text-anchor="middle" fill="white">Needs: Quality Checks</text>
  
  <rect x="870" y="790" width="260" height="50" rx="5" fill="white" opacity="0.9"/>
  <text x="1000" y="810" font-size="10" text-anchor="middle" fill="#333">Setup Vercel</text>
  <text x="1000" y="825" font-size="9" text-anchor="middle" fill="#666">Build & Deploy</text>
  
  <!-- Deploy Production Job -->
  <rect x="1200" y="720" width="300" height="180" rx="8" fill="url(#jobGrad)" opacity="0.9"/>
  <text x="1350" y="750" font-size="14" font-weight="bold" text-anchor="middle" fill="white">Deploy Production</text>
  <text x="1350" y="770" font-size="11" text-anchor="middle" fill="white">Needs: Quality Checks</text>
  <text x="1350" y="785" font-size="10" text-anchor="middle" fill="white" opacity="0.9">Only: main branch</text>
  
  <rect x="1220" y="800" width="260" height="50" rx="5" fill="white" opacity="0.9"/>
  <text x="1350" y="810" font-size="10" text-anchor="middle" fill="#333">Setup Vercel</text>
  <text x="1350" y="825" font-size="9" text-anchor="middle" fill="#666">Build & Deploy (--prod)</text>
  
  <!-- Dependencies arrows -->
  <path d="M 800 880 L 850 810" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <path d="M 800 880 L 1200 810" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Vercel Deployment -->
  <rect x="100" y="1080" width="1400" height="70" rx="8" fill="#0070F3" opacity="0.15" stroke="#0070F3" stroke-width="2"/>
  <text x="800" y="1105" font-size="15" font-weight="bold" text-anchor="middle" fill="#0070F3">Vercel Deployment</text>
  <text x="800" y="1125" font-size="11" text-anchor="middle" fill="#666">Preview & Production Environments</text>
  <text x="800" y="1140" font-size="10" text-anchor="middle" fill="#999">Automatic SSL, CDN, Serverless Functions</text>
  
  <!-- Arrow to next workflow -->
  <path d="M 800 1140 L 800 1280" stroke="#666" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- Workflow 2: Test Sync -->
  <rect x="50" y="1280" width="1500" height="380" rx="10" fill="white" stroke="#E0E0E0" stroke-width="2" filter="url(#shadow)"/>
  <rect x="70" y="1300" width="1460" height="40" rx="5" fill="url(#workflowGrad)" opacity="0.9"/>
  <text x="800" y="1325" font-size="18" font-weight="bold" text-anchor="middle" fill="white">Workflow 2: Sync Test Results (automaspec-sync.yml)</text>
  
  <rect x="100" y="1360" width="1400" height="260" rx="8" fill="url(#jobGrad)" opacity="0.9"/>
  <text x="800" y="1390" font-size="16" font-weight="bold" text-anchor="middle" fill="white">Job: Test and Sync</text>
  <text x="800" y="1410" font-size="12" text-anchor="middle" fill="white">Runner: ubuntu-latest</text>
  
  <rect x="130" y="1440" width="1340" height="30" rx="5" fill="white" opacity="0.9"/>
  <text x="800" y="1460" font-size="11" text-anchor="middle" fill="#333">1. Setup environment (pnpm, Node.js 22)</text>
  
  <rect x="130" y="1480" width="1340" height="30" rx="5" fill="white" opacity="0.9"/>
  <text x="800" y="1500" font-size="11" text-anchor="middle" fill="#333">2. Install dependencies</text>
  
  <rect x="130" y="1520" width="1340" height="30" rx="5" fill="white" opacity="0.9"/>
  <text x="800" y="1540" font-size="11" text-anchor="middle" fill="#333">3. Run tests â†’ test-results.json</text>
  
  <rect x="130" y="1560" width="1340" height="30" rx="5" fill="#E5F5FF" opacity="0.8"/>
  <text x="800" y="1580" font-size="11" font-weight="bold" text-anchor="middle" fill="#0066CC">4. Sync to Automaspec webhook</text>
  
  <!-- Webhook endpoint -->
  <rect x="100" y="1600" width="1400" height="70" rx="8" fill="#E5F5FF" opacity="0.6" stroke="#0066CC" stroke-width="2"/>
  <text x="800" y="1625" font-size="13" font-weight="bold" text-anchor="middle" fill="#0066CC">Automaspec Webhook</text>
  <text x="800" y="1645" font-size="11" text-anchor="middle" fill="#333">POST /api/webhook/sync-tests</text>
  <text x="800" y="1660" font-size="10" text-anchor="middle" fill="#666">Receives test results JSON payload</text>
</svg>

