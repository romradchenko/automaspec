pre-commit:
    jobs:
        - name: db-check
          glob: 'db/schema/*.ts'
          run: pnpm drizzle-kit check
          fail_text: '❌ Database schema validation failed'

        - name: format
          glob: '*.{ts,tsx,mts}'
          run: pnpx oxfmt {staged_files}
          stage_fixed: true
          fail_text: '❌ Oxfmt failed'

        - name: lint
          run: pnpx oxlint {staged_files} --fix --fix-suggestions --fix-dangerously --deny-warnings
          stage_fixed: true
          fail_text: '❌ Oxlint failed'

        - name: todo-check
          glob: '*.{ts,tsx,mts}'
          run: |
              if grep -n "TODO\|FIXME" {staged_files}; then
                echo "⚠️  TODO/FIXME comments found. Consider addressing them."
              fi

# TODO: Enable this
# pre-push:
#     parallel: true
#     jobs:
#         - name: typecheck
#           run: pnpx next typegen && pnpx --package=typescript tsc --noEmit
#           fail_text: '❌ TypeScript type checking failed'

#         - name: test
#           run: pnpm test
#           fail_text: '❌ Test failed'

colors: true
