pre-commit:
    jobs:
        - name: db-check
          glob: 'db/schema/*.ts'
          run: pnpm dbc
          fail_text: '❌ Database schema validation failed'

        - name: format
          glob: '*.{ts,tsx,mts}'
          run: pnpm format {staged_files}
          stage_fixed: true
          fail_text: '❌ oxfmt failed'

        - name: lint
          glob: '*.{ts,tsx,mts}'
          run: pnpm lint {staged_files}
          stage_fixed: true
          fail_text: '❌ oxlint failed'

        - name: todo-check
          glob: '*.{ts,tsx,mts,md,!lefthook.yml}'
          run: |
              if grep -n "TODO\|FIXME" {staged_files}; then
                echo "⚠️  TODO/FIXME comments found. Consider addressing them."
              fi

pre-push:
    parallel: true
    jobs:
        - name: typecheck
          run: pnpm typecheck
          fail_text: '❌ TypeScript type checking failed'

# TODO: Enable this
#         - name: test
#           run: pnpm test
#           fail_text: '❌ Test failed'

colors: true
